# Story 2.4: Sidebar Toggle (Mobile/Desktop)

## Status
Done

## Story
**As a** user,
**I want** to collapse the sidebar,
**so that** I have more space for my board on smaller screens.

## Acceptance Criteria

| # | Critério |
|---|----------|
| AC1 | Botão hamburger (☰) no header toggle sidebar |
| AC2 | Sidebar colapsada mostra apenas ícones |
| AC3 | Sidebar expandida mostra nome + tipo do board |
| AC4 | Transição suave (200ms) entre estados |
| AC5 | Estado da sidebar persiste (localStorage) |
| AC6 | Em mobile (<768px), sidebar é overlay com backdrop |
| AC7 | Keyboard shortcut: Ctrl+B toggle sidebar |

## Tasks / Subtasks

- [x] Task 1: Criar componente Header (AC1)
  - [x] Criar src/components/Header/Header.tsx
  - [x] Botão hamburger (☰) à esquerda
  - [x] Título do app ou board ativo ao centro
  - [x] Botão Import à direita (placeholder)
- [x] Task 2: Implementar toggle no store (AC5)
  - [x] toggleSidebar action já existe no Zustand
  - [x] sidebarOpen state já persiste via middleware
  - [x] Verificar funcionamento
- [x] Task 3: Atualizar Sidebar para collapsed state (AC2, AC3, AC4)
  - [x] Prop isCollapsed baseada em sidebarOpen
  - [x] Largura: 180px (expanded) vs 48px (collapsed)
  - [x] Transição: transition-all duration-200
  - [x] Collapsed: mostrar apenas ícone do board
  - [x] Expanded: mostrar nome + tipo
- [x] Task 4: Implementar mobile overlay (AC6)
  - [x] Detectar viewport < 768px
  - [x] Sidebar como overlay (position fixed)
  - [x] Backdrop escuro atrás
  - [x] Click no backdrop fecha sidebar
  - [x] z-index apropriado
- [x] Task 5: Implementar keyboard shortcut (AC7)
  - [x] Atualizar src/hooks/useKeyboardShortcuts.ts
  - [x] Ctrl+B (ou Cmd+B no Mac) toggle sidebar
  - [x] Verificar que não conflita com browser
- [x] Task 6: Integrar Header no layout
  - [x] Atualizar App.tsx
  - [x] Header fixo no topo
  - [x] Board abaixo com altura restante

## Dev Notes

### Estados da Sidebar (de PRD)
- **Expanded**: 180px, mostra nome + tipo do board
- **Collapsed**: 48px, mostra apenas ícones
- **Mobile**: overlay com backdrop escuro

### Header Component
```typescript
import { useAppStore } from '../../store';

export const Header = () => {
  const toggleSidebar = useAppStore(state => state.toggleSidebar);

  return (
    <header className="h-12 border-b flex items-center px-4">
      <button onClick={toggleSidebar} className="p-2">
        ☰
      </button>
      <h1 className="ml-4 font-semibold">Miplan</h1>
    </header>
  );
};
```

### Sidebar Collapsed State
```typescript
interface SidebarProps {
  isCollapsed: boolean;
}

export const Sidebar = ({ isCollapsed }: SidebarProps) => {
  return (
    <aside
      className={`
        bg-white border-r transition-all duration-200
        ${isCollapsed ? 'w-12' : 'w-[180px]'}
      `}
    >
      {isCollapsed ? (
        <CollapsedBoardList />
      ) : (
        <ExpandedBoardList />
      )}
    </aside>
  );
};
```

### Mobile Overlay
```typescript
const isMobile = useMediaQuery('(max-width: 767px)');

if (isMobile) {
  return (
    <>
      {sidebarOpen && (
        <div
          className="fixed inset-0 bg-black/50 z-40"
          onClick={toggleSidebar}
        />
      )}
      <aside
        className={`
          fixed top-0 left-0 h-full w-[180px] bg-white z-50
          transform transition-transform duration-200
          ${sidebarOpen ? 'translate-x-0' : '-translate-x-full'}
        `}
      >
        {/* content */}
      </aside>
    </>
  );
}
```

### Keyboard Shortcut
```typescript
// Em useKeyboardShortcuts.ts
case 'b':
  if (e.ctrlKey || e.metaKey) {
    e.preventDefault();
    toggleSidebar();
  }
  break;
```

### Testing
- Click no hamburger toggle sidebar
- Animação suave funciona
- Estado persiste no refresh
- Mobile mostra como overlay
- Ctrl+B funciona

## Definition of Done
- [x] Click no hamburger toggle sidebar
- [x] Animação suave funciona
- [x] Estado persiste no refresh
- [x] Mobile mostra como overlay
- [x] Ctrl+B funciona

## Story Points
3

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2026-01-31 | 0.1 | Story criada a partir do PRD | River (SM) |
| 2026-01-31 | 1.0 | Implementation complete | Dex (Dev) |

---

## Dev Agent Record

### Agent Model Used
Claude Opus 4.5 (claude-opus-4-5-20251101)

### Debug Log References
N/A - Implementation completed without errors

### Completion Notes List
- Created Header component with hamburger toggle button, app title, and Import button placeholder
- Created useKeyboardShortcuts hook with Ctrl+B/Cmd+B support for sidebar toggle
- Updated Sidebar component with collapsed state (48px width with icons only) and mobile overlay mode (<768px)
- Updated App.tsx to include Header at top with proper flex layout
- Smooth 200ms transitions implemented using Tailwind's transition-all duration-200
- State persistence already handled by Zustand persist middleware (existing)
- Mobile overlay includes backdrop with click-to-close functionality
- BoardItem and BoardList components updated to support isCollapsed prop for collapsed view

### File List
| File | Action | Description |
|------|--------|-------------|
| `src/components/Header/Header.tsx` | Created | Header component with hamburger button, title, and Import placeholder |
| `src/hooks/useKeyboardShortcuts.ts` | Created | Keyboard shortcuts hook with Ctrl+B sidebar toggle |
| `src/components/Sidebar/Sidebar.tsx` | Modified | Added collapsed state and mobile overlay mode |
| `src/components/Sidebar/BoardList.tsx` | Modified | Added isCollapsed and onBoardSelect props |
| `src/components/Sidebar/BoardItem.tsx` | Modified | Added isCollapsed prop for icon-only view |
| `src/App.tsx` | Modified | Added Header component and restructured layout |

---

## QA Results
*To be filled by QA agent*
