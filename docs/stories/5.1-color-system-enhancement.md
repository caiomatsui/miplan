# Story 5.1: Color System Enhancement

## Story Info
- **Epic:** [Epic 5 - Professional UI/UX Polish](./epic-5-professional-ui-polish.md)
- **Points:** 5
- **Priority:** P0 (Foundation)
- **Dependencies:** Epic 4 complete

## User Story

**As a** user viewing the Miplan interface,
**I want** colors to convey meaningful information at a glance,
**So that** I can quickly understand task status, priority, and context without reading text.

## Background

Current state:
- Primary indigo dominates with limited visual variety
- Priority badges use text symbols (!, −, ↓) over color
- Status columns lack color differentiation
- Label colors are predefined but limited

Target state (reference: Linear, Todoist):
- Semantic colors communicate meaning instantly
- Priority has clear color spectrum (red → orange → blue → gray)
- Status columns have subtle background tints
- Expanded palette with consistent OKLCH foundations

## Acceptance Criteria

### AC1: Priority Color Spectrum
- [ ] Critical/Urgent: Red spectrum (`oklch(0.55 0.25 25)`)
- [ ] High: Orange/amber spectrum (`oklch(0.65 0.20 45)`)
- [ ] Medium: Blue spectrum (`oklch(0.70 0.15 220)`)
- [ ] Low: Gray/neutral (`oklch(0.65 0.08 280)`)
- [ ] None: Transparent/subtle
- [ ] Colors work in both light and dark themes
- [ ] Contrast ratio meets WCAG AA (4.5:1 for text)

### AC2: Status Color Tokens
- [ ] Todo/Backlog: Neutral gray tint
- [ ] In Progress: Amber/yellow subtle tint
- [ ] Done/Complete: Green subtle tint
- [ ] Blocked: Red subtle tint (if status exists)
- [ ] Column headers can optionally show status color accent

### AC3: Surface Hierarchy
- [ ] `--surface-base`: Default background
- [ ] `--surface-elevated`: Cards, floating elements
- [ ] `--surface-sunken`: Inset areas, code blocks
- [ ] `--surface-overlay`: Modals, sheets
- [ ] Proper elevation shadows accompany surface levels

### AC4: Interactive State Colors
- [ ] `--hover`: Consistent hover tint across interactive elements
- [ ] `--active`: Pressed/active state
- [ ] `--focus`: Focus ring color (accessible)
- [ ] `--selected`: Selected item background
- [ ] States work on all surface levels

### AC5: Extended Semantic Palette
- [ ] Success: Green for confirmations, completed actions
- [ ] Warning: Amber for cautions, time-sensitive items
- [ ] Error/Destructive: Red for errors, delete actions
- [ ] Info: Blue for informational messages
- [ ] Each has foreground and background variants

### AC6: Label Color Expansion
- [ ] Minimum 12 label color options (up from current set)
- [ ] Colors are visually distinct from each other
- [ ] Each color has accessible text contrast
- [ ] Colors remain vibrant in dark mode

## Technical Implementation

### File Changes
| File | Changes |
|------|---------|
| `src/index.css` | Add new CSS custom properties |
| `tailwind.config.js` | Extend theme with new colors |
| `src/components/Task/PriorityBadge.tsx` | Update to use new priority colors |
| `src/components/Task/LabelBadge.tsx` | Support expanded label colors |

### CSS Token Structure
```css
:root {
  /* Priority spectrum */
  --priority-critical: oklch(0.55 0.25 25);
  --priority-critical-bg: oklch(0.95 0.04 25);
  --priority-high: oklch(0.65 0.20 45);
  --priority-high-bg: oklch(0.95 0.04 45);
  --priority-medium: oklch(0.55 0.18 220);
  --priority-medium-bg: oklch(0.95 0.03 220);
  --priority-low: oklch(0.55 0.05 280);
  --priority-low-bg: oklch(0.96 0.01 280);

  /* Status colors */
  --status-todo: oklch(0.50 0.02 280);
  --status-progress: oklch(0.65 0.18 85);
  --status-done: oklch(0.55 0.18 145);
  --status-blocked: oklch(0.55 0.22 25);

  /* Surfaces */
  --surface-base: var(--background);
  --surface-elevated: oklch(0.995 0.003 280);
  --surface-sunken: oklch(0.97 0.008 280);
  --surface-overlay: oklch(1 0 0 / 0.8);

  /* Interactive states */
  --state-hover: oklch(0.96 0.01 280);
  --state-active: oklch(0.94 0.015 280);
  --state-focus: var(--primary);
  --state-selected: oklch(0.95 0.03 280);
}

.dark {
  /* Dark mode overrides */
  --priority-critical-bg: oklch(0.25 0.08 25);
  --priority-high-bg: oklch(0.25 0.06 45);
  --priority-medium-bg: oklch(0.22 0.05 220);
  --priority-low-bg: oklch(0.18 0.02 280);

  --surface-elevated: oklch(0.18 0.02 280);
  --surface-sunken: oklch(0.12 0.015 280);
  --surface-overlay: oklch(0.08 0.02 280 / 0.9);

  --state-hover: oklch(0.22 0.02 280);
  --state-active: oklch(0.25 0.025 280);
  --state-selected: oklch(0.20 0.04 280);
}
```

### Tailwind Extension
```js
// tailwind.config.js
colors: {
  priority: {
    critical: 'var(--priority-critical)',
    'critical-bg': 'var(--priority-critical-bg)',
    high: 'var(--priority-high)',
    'high-bg': 'var(--priority-high-bg)',
    medium: 'var(--priority-medium)',
    'medium-bg': 'var(--priority-medium-bg)',
    low: 'var(--priority-low)',
    'low-bg': 'var(--priority-low-bg)',
  },
  status: {
    todo: 'var(--status-todo)',
    progress: 'var(--status-progress)',
    done: 'var(--status-done)',
    blocked: 'var(--status-blocked)',
  },
  surface: {
    base: 'var(--surface-base)',
    elevated: 'var(--surface-elevated)',
    sunken: 'var(--surface-sunken)',
    overlay: 'var(--surface-overlay)',
  },
}
```

## Testing Requirements

- [ ] Visual regression: Compare before/after screenshots
- [ ] Dark mode: Toggle and verify all colors
- [ ] Contrast check: Run axe accessibility audit
- [ ] Label combinations: Test all 12 colors on cards

## Definition of Done

- [ ] All CSS tokens defined in index.css
- [ ] Tailwind config extended
- [ ] PriorityBadge uses new color spectrum
- [ ] Both themes pass WCAG AA contrast
- [ ] No visual regressions in existing components
- [ ] Story checkboxes complete

## Design References

- Linear priority colors: Red (urgent), Orange (high), Blue (medium), Gray (low)
- Todoist priority flags: Red (P1), Orange (P2), Blue (P3), None (P4)
- Notion status: Gray (todo), Yellow (in progress), Green (done)

---

*Agent: @dev*
*Created: 2026-01-31*
