# Story 8.4: Add "Don't Ask Again" to Delete Confirmation

## Status: Ready for Review

## Description
Add a "Don't ask me again" checkbox to the delete task confirmation dialog. When checked, future delete actions will skip the confirmation and delete immediately.

## Acceptance Criteria
- [ ] Checkbox labeled "Don't ask me again" appears in the delete confirmation dialog
- [ ] When checked and confirmed, future deletes skip the confirmation
- [ ] Preference is stored in localStorage (key: `miplan-skip-delete-confirm`)
- [ ] There's a way to re-enable confirmations (in settings or via keyboard shortcut)
- [ ] Visual indicator somewhere that confirmations are disabled (optional toast or subtle UI hint)

## Technical Design

### Storage
Use localStorage for simplicity:
```typescript
const SKIP_CONFIRM_KEY = 'miplan-skip-delete-confirm';

// Store preference
localStorage.setItem(SKIP_CONFIRM_KEY, 'true');

// Check preference
const skipConfirm = localStorage.getItem(SKIP_CONFIRM_KEY) === 'true';
```

Alternatively, add to Zustand UIStore (persisted via zustand-persist):
```typescript
// In store/index.ts UIStore
skipDeleteConfirm: boolean;
setSkipDeleteConfirm: (skip: boolean) => void;
```

### UI Changes

#### ConfirmDialog.tsx
Add optional checkbox prop:
```typescript
interface ConfirmDialogProps {
  // existing props...
  showDontAskAgain?: boolean;
  onDontAskAgainChange?: (checked: boolean) => void;
}
```

#### Delete Flow
```typescript
// In TaskDetailSheet or wherever delete is triggered
const handleDelete = () => {
  const skipConfirm = localStorage.getItem('miplan-skip-delete-confirm') === 'true';

  if (skipConfirm) {
    // Delete immediately
    deleteTask();
  } else {
    // Show confirmation
    setShowDeleteConfirm(true);
  }
};

const handleConfirmDelete = (dontAskAgain: boolean) => {
  if (dontAskAgain) {
    localStorage.setItem('miplan-skip-delete-confirm', 'true');
  }
  deleteTask();
};
```

### Re-Enable Confirmations
Option 1: Add to Settings panel (if exists)
Option 2: Add keyboard shortcut hint in a tooltip
Option 3: Show subtle toast "Delete confirmations disabled. Hold Shift+Delete to re-enable"

For MVP, add a simple utility:
```typescript
// Can be called from console or a settings UI later
window.resetDeleteConfirmation = () => {
  localStorage.removeItem('miplan-skip-delete-confirm');
  console.log('Delete confirmations re-enabled');
};
```

## Tasks
- [x] Add checkbox to ConfirmDialog component
- [x] Wire up localStorage storage on confirm
- [x] Check preference before showing dialog in TaskDetailSheet
- [ ] Check preference in any other delete locations (column delete, etc.)
- [x] Add way to re-enable (dev console for now, UI later)
- [ ] Test the full flow

## Dev Agent Record

### Implementation
1. **ConfirmDialog.tsx**: Added `showDontAskAgain` prop and internal checkbox state
   - Checkbox labeled "Don't ask me again"
   - State resets when dialog closes
   - `onConfirm` callback now receives `dontAskAgain` boolean

2. **TaskDetailSheet.tsx**:
   - Added `handleDeleteClick` that checks localStorage before showing dialog
   - Added `handleConfirmDelete` that saves preference if checkbox was checked
   - Uses localStorage key: `miplan-skip-delete-confirm`

### Re-enabling Confirmations
Users can re-enable by clearing localStorage:
```javascript
localStorage.removeItem('miplan-skip-delete-confirm')
```

### File List
- `src/components/ui/ConfirmDialog.tsx` - Added checkbox and showDontAskAgain prop
- `src/components/Task/TaskDetailSheet.tsx` - Check preference, handle storage

## File Changes
```
src/components/ui/ConfirmDialog.tsx     # Add checkbox UI
src/components/Task/TaskDetailSheet.tsx # Check preference before showing dialog
src/components/Board/ColumnMenu.tsx     # If column delete uses same pattern
```

## UI Mockup
```
┌─────────────────────────────────────┐
│ Delete Task                         │
├─────────────────────────────────────┤
│                                     │
│ Are you sure you want to delete     │
│ this task? This action cannot be    │
│ undone.                             │
│                                     │
│ ☐ Don't ask me again               │
│                                     │
├─────────────────────────────────────┤
│              [Cancel]  [Delete]     │
└─────────────────────────────────────┘
```

## Testing
1. Open task detail sheet
2. Click Delete Task
3. Verify checkbox appears
4. Check the checkbox
5. Click Delete
6. Create new task
7. Delete it → should delete immediately without confirmation
8. Verify localStorage has the key set
9. Clear localStorage manually
10. Delete should show confirmation again

## Edge Cases
- Multiple tabs: Each tab reads localStorage independently, so change is immediate
- Clear browser data: Preference resets, confirmations return

## Future Enhancements
- Settings panel with preference toggle
- Toast notification when preference is set
- Undo option for immediate deletes (more user-friendly)

## Story Points: 3
